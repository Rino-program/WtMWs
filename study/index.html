<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Study Support</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="./studyt_style.css">
  <link rel="icon" href="../img/title.png">
</head>
<body>
  <header class="app-header">
    <h1 class="app-title">Study Support</h1>
    <nav class="tabs">
      <button class="tab-button is-active" data-tab="session" aria-selected="true">セッション</button>
      <button class="tab-button" data-tab="dashboard" aria-selected="false">ダッシュボード</button>
      <button class="tab-button" data-tab="settings" aria-selected="false">設定</button>
    </nav>
  </header>
  <main>
    <section id="section-session" class="tab-pane is-active">
      <div class="session-layout">
        <aside class="task-panel">
          <div class="panel-header">
            <h2>タスク管理</h2>
            <div class="task-actions">
              <button id="add-task-btn" class="btn-icon" title="タスク追加">➕</button>
              <button id="toggle-view-btn" class="btn-icon" title="選択式表示に切替">📊</button>
            </div>
          </div>
          <div id="current-task-display" class="current-task-card">
            <div class="task-header">
              <span class="current-label">現在のタスク</span>
            </div>
            <div class="current-task">
              <div class="task-title"></div>
              <div class="task-meta"></div>
              <div class="task-notes"></div>
            </div>
          </div>
          <div id="task-list" class="task-list">
            <h3>タスク一覧</h3>
            <div id="task-items" class="task-items"></div>
          </div>
          <div id="task-selector" class="hidden">
            <select id="task-select"></select>
            <button id="change-task-btn" class="btn-small">詳細表示に切替</button>
            <button id="delete-task-btn" class="btn-small danger">選択タスク削除</button>
          </div>
          <form id="new-task-form" class="task-form hidden" aria-hidden="true">
            <h3>新規タスク追加</h3>
            <input id="new-task-title" type="text" placeholder="タイトル" required>
            <input id="new-task-subject" type="text" placeholder="科目/カテゴリ">
            <input id="new-task-notes" type="text" placeholder="メモ">
            <input id="new-task-goal" type="number" min="0" max="999" placeholder="目標時間(分)">
            <div class="form-actions">
              <button id="save-task-btn" class="primary btn-small" type="submit">保存</button>
              <button id="cancel-task-btn" class="btn-small" type="button">キャンセル</button>
            </div>
          </form>
        </aside>
        <section class="timer-panel">
          <div class="panel-header">
            <h2>ポモドーロタイマー</h2>
          </div>
          <div class="timer-container">
            <div class="session-info">
              <span id="mode-label" class="timer-mode">🎯 集中</span>
              <span class="separator">|</span>
              <span id="round-label">Round 1</span>
            </div>
            <div class="progress-ring">
              <svg class="progress-svg" width="200" height="200">
                <circle class="progress-bg" cx="100" cy="100" r="90" />
                <circle id="progress-circle" class="progress-bar" cx="100" cy="100" r="90" />
              </svg>
              <div class="timer-display">
                <div id="time-left" class="time">25:00</div>
                <div id="time-percent" class="time-percent">100%</div>
              </div>
            </div>
            <div class="controls">
              <button id="start-btn" class="primary btn-large">スタート</button>
              <button id="pause-btn" class="btn-large">一時停止</button>
              <button id="resume-btn" class="primary btn-large">再開</button>
              <button id="skip-btn" class="btn-large">スキップ</button>
              <button id="reset-btn" class="btn-large danger">リセット</button>
            </div>
            <div class="session-stats">
              <div class="stat-item">
                <span class="stat-label">今日の集中</span>
                <span id="today-focus-time" class="stat-value">0分</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">今日の回数</span>
                <span id="streak-count" class="stat-value">0</span>
              </div>
            </div>
            <div class="shortcuts-hint">
              <span>ショートカット: <kbd>Space</kbd> 開始/一時停止, <kbd>S</kbd> スキップ, <kbd>R</kbd> リセット, <kbd>1-3</kbd> タブ切替</span>
            </div>
          </div>
        </section>
      </div>
    </section>
    <section id="section-dashboard" class="tab-pane">
      <div class="dashboard-layout">
        <div class="stats-overview">
          <div class="stat-card">
            <span class="stat-icon">⏱️</span>
            <div class="stat-content">
              <span id="total-focus-time" class="stat-value">0分</span>
              <span class="stat-label">総集中時間</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">📝</span>
            <div class="stat-content">
              <span id="total-sessions" class="stat-value">0</span>
              <span class="stat-label">総セッション数</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">🔥</span>
            <div class="stat-content">
              <span id="current-streak" class="stat-value">0</span>
              <span class="stat-label">連続日数</span>
            </div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">🎯</span>
            <div class="stat-content">
              <span id="efficiency-rate" class="stat-value">0%</span>
              <span class="stat-label">効率率</span>
            </div>
          </div>
        </div>
        <div class="period-stats">
          <div class="card today-summary">
            <div class="summary-item">
              <span class="summary-label">今日の合計</span>
              <span id="today-total" class="summary-value">0分</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">今日の回数</span>
              <span id="today-count" class="summary-value">0</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">目標進捗</span>
              <span id="today-goal-progress" class="summary-value">0%</span>
            </div>
          </div>
          <div class="card week-summary">
            <div class="summary-item">
              <span class="summary-label">週間合計</span>
              <span id="week-total" class="summary-value">0分</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">週間平均</span>
              <span id="week-average" class="summary-value">0分</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">ベスト日</span>
              <span id="week-best" class="summary-value">0分</span>
            </div>
          </div>
        </div>
        <div class="week-chart card">
          <div class="card-header">
            <h2>週間チャート</h2>
          </div>
          <div id="week-chart-bars" class="chart-bars"></div>
        </div>
        <div class="task-breakdown card">
          <div class="card-header">
            <h2>週間タスク内訳</h2>
          </div>
          <div id="week-task-breakdown"></div>
        </div>
        <div class="task-progress-list card">
          <div class="card-header">
            <h2>今日のタスク進捗</h2>
          </div>
          <div id="today-task-progress"></div>
        </div>
        <div class="session-history card">
          <div class="card-header">
            <h2>今日のセッション履歴</h2>
          </div>
          <div id="today-sessions"></div>
        </div>
      </div>
    </section>
    <section id="section-settings" class="tab-pane">
      <div class="settings-layout">
        <div class="settings-grid">
          <div class="setting-item">
            <label for="focus-min">集中時間(分)</label>
            <input id="focus-min" type="number" min="1" max="120">
          </div>
          <div class="setting-item">
            <label for="short-min">短休憩(分)</label>
            <input id="short-min" type="number" min="1" max="60">
          </div>
          <div class="setting-item">
            <label for="long-min">長休憩(分)</label>
            <input id="long-min" type="number" min="1" max="120">
          </div>
          <div class="setting-item">
            <label for="rounds-until-long">ラウンド数(長休憩まで)</label>
            <input id="rounds-until-long" type="number" min="1" max="12">
          </div>
        </div>
        <div class="goal-settings">
          <div class="setting-item">
            <label for="daily-goal">日次目標(分)</label>
            <input id="daily-goal" type="number" min="0" max="999">
          </div>
          <div class="setting-item">
            <label for="weekly-goal">週次目標(分)</label>
            <input id="weekly-goal" type="number" min="0" max="9999">
          </div>
          <button id="save-goals-btn" class="primary btn-small">目標保存</button>
        </div>
        <div class="notification-settings">
          <div class="setting-item checkbox-label">
            <label><input id="notify-break-start" type="checkbox">休憩開始時に通知</label>
          </div>
          <div class="setting-item checkbox-label">
            <label><input id="notify-break-end" type="checkbox">休憩終了時に通知</label>
          </div>
          <div class="setting-item checkbox-label">
            <label><input id="notify-goal-achieved" type="checkbox">目標達成時に通知</label>
          </div>
          <button id="test-notification" class="btn-small">通知テスト</button>
        </div>
        <div class="appearance-settings">
          <div class="setting-item">
            <label for="theme-select">テーマ</label>
            <select id="theme-select">
              <option value="system">システム</option>
              <option value="light">ライト</option>
              <option value="dark">ダーク</option>
            </select>
          </div>
          <div class="setting-item checkbox-label">
            <label><input id="show-seconds" type="checkbox">秒表示</label>
          </div>
          <div class="setting-item checkbox-label">
            <label><input id="compact-mode" type="checkbox">コンパクト表示</label>
          </div>
        </div>
        <div class="data-info">
          <div class="info-item">
            <span class="info-label">タスク数</span>
            <span id="task-count" class="info-value">0</span>
          </div>
          <div class="info-item">
            <span class="info-label">セッション数</span>
            <span id="session-count" class="info-value">0</span>
          </div>
          <div class="info-item">
            <span class="info-label">データ容量</span>
            <span id="data-size" class="info-value">0 KB</span>
          </div>
        </div>
        <div class="data-actions">
          <button id="export-btn" class="btn-small">データエクスポート</button>
          <label class="file-label"><input id="import-file" type="file" accept=".json"><span>データインポート</span></label>
          <button id="clear-data-btn" class="danger btn-small">全データ削除</button>
        </div>
        <div class="app-info">
          <p>Study Support v0.2 Enhanced<br>© 2025 Rino-program</p>
        </div>
      </div>
    </section>
  </main>
  <footer class="app-footer">
    <span>Study Support v0.2 Enhanced | © 2025 Rino-program</span>
  </footer>
  <script src="./app.js"></script>
</body>
</html>
