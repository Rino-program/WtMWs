:root{
  --bg:#0b1220;
  --bg-2:#0f172a;
  --bg-3:#1e293b;
  --text:#e5e7eb;
  --text-muted:#94a3b8;
  --text-light:#cbd5e1;
  --primary:#22c55e;
  --primary-dark:#16a34a;
  --primary-light:#34d399;
  --secondary:#334155;
  --secondary-light:#475569;
  --danger:#ef4444;
  --warning:#f59e0b;
  --info:#3b82f6;
  --success:#10b981;
  --card:#111827;
  --card-hover:#1f2937;
  --border:#1f2937;
  --border-light:#374151;
  --shadow:0 4px 6px -1px rgba(0,0,0,0.3);
  --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.4);
  --shadow-xl:0 20px 25px -5px rgba(0,0,0,0.5);
  --radius:8px;
  --radius-lg:12px;
  --gradient-primary:linear-gradient(135deg, var(--primary), var(--primary-dark));
  --gradient-danger:linear-gradient(135deg, var(--danger), #dc2626);
  --gradient-bg:linear-gradient(135deg, var(--bg), var(--bg-2));
  --glass-bg:rgba(255, 255, 255, 0.05);
  --glass-border:rgba(255, 255, 255, 0.1);
}

@media (prefers-color-scheme: light){
  :root[data-theme="light"],
  :root:not([data-theme]){
    --bg:#f8fafc; --bg-2:#ffffff; --bg-3:#f1f5f9; --text:#0f172a; --text-muted:#475569; --text-light:#1e293b;
    --primary:#16a34a; --primary-dark:#15803d; --primary-light:#22c55e; --secondary:#e2e8f0; --secondary-light:#cbd5e1; --danger:#dc2626; --warning:#d97706; --info:#2563eb; --success:#059669;
    --card:#ffffff; --card-hover:#f8fafc; --border:#e5e7eb; --border-light:#d1d5db; --shadow:0 4px 6px -1px rgba(0,0,0,0.1); --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.15); --shadow-xl:0 20px 25px -5px rgba(0,0,0,0.2);
    --gradient-primary:linear-gradient(135deg, var(--primary), var(--primary-dark)); --gradient-danger:linear-gradient(135deg, var(--danger), #b91c1c); --gradient-bg:linear-gradient(135deg, var(--bg), var(--bg-2));
    --glass-bg:rgba(0, 0, 0, 0.03); --glass-border:rgba(0, 0, 0, 0.08);
  }
}

@media (prefers-color-scheme: dark){
  :root[data-theme="dark"]{
    --bg:#0b1220; --bg-2:#0f172a; --bg-3:#1e293b; --text:#e5e7eb; --text-muted:#94a3b8; --text-light:#cbd5e1;
    --primary:#22c55e; --primary-dark:#16a34a; --secondary:#334155; --secondary-light:#475569; --danger:#ef4444; --warning:#f59e0b; --info:#3b82f6; --success:#10b981;
    --card:#111827; --card-hover:#1f2937; --border:#1f2937; --border-light:#374151; --shadow:0 4px 6px -1px rgba(0,0,0,0.3); --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.4);
  }
}

*{box-sizing:border-box}
html,body{height:100%; margin:0; padding:0; scroll-behavior:smooth}
body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text); background:var(--gradient-bg);
  line-height:1.6; font-size:14px; overflow-x:hidden;
}

/* アニメーション */
@keyframes fadeIn { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
@keyframes slideIn { from{transform:translateX(-100%)} to{transform:translateX(0)} }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
@keyframes glow { 0%,100%{box-shadow:0 0 20px rgba(34,197,94,0.3)} 50%{box-shadow:0 0 30px rgba(34,197,94,0.6)} }
@keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
@keyframes bounce { 0%,20%,53%,80%,100%{transform:translateY(0)} 40%,43%{transform:translateY(-8px)} 70%{transform:translateY(-4px)} }

.animate-fadeIn { animation: fadeIn 0.5s ease-out }
.animate-slideIn { animation: slideIn 0.3s ease-out }
.animate-pulse { animation: pulse 2s infinite }
.animate-glow { animation: glow 3s infinite }
.animate-shake { animation: shake 0.5s ease-in-out }
.animate-bounce { animation: bounce 1s ease-in-out }

/* グラスモーフィズム効果 */
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
}

/* グラデーション背景 */
.gradient-primary { background: var(--gradient-primary) }
.gradient-danger { background: var(--gradient-danger) }

/* Header */
.app-header{
  display:flex; gap:16px; align-items:center; justify-content:space-between; 
  padding:20px 24px; border-bottom:1px solid var(--border); 
  position:sticky; top:0; z-index:100;
  backdrop-filter: blur(20px); background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  box-shadow:var(--shadow-lg);
  animation: slideIn 0.5s ease-out;
}
.app-title{
  margin:0; font-size:28px; font-weight:800; 
  color:var(--primary);
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}
/* Webkit向けのグラデーション効果（フォールバック付き） */
@supports (-webkit-background-clip: text) {
  .app-title {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
}
.tabs{display:flex; gap:6px;}
.tab-button{
  background:var(--secondary); color:var(--text); border:1px solid var(--border); 
  border-radius:var(--radius); padding:12px 20px; cursor:pointer; font-weight:600;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position:relative;
  overflow:hidden;
}
.tab-button::before{
  content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  transition:left 0.5s ease;
}
.tab-button:hover{
  background:var(--secondary-light); transform:translateY(-2px);
  box-shadow:var(--shadow);
}
.tab-button:hover::before{left:100%}
.tab-button.is-active{
  background:var(--gradient-primary); color:white; border-color:var(--primary); 
  box-shadow:var(--shadow-lg); transform:translateY(-1px);
}

/* Layout */
main{max-width:1400px; margin:0 auto; padding:24px 16px}

/* Session Layout */
.session-layout{display:grid; grid-template-columns:400px 1fr; gap:24px; min-height:calc(100vh - 200px)}
@media (max-width:1024px){.session-layout{grid-template-columns:1fr; gap:16px}}

/* Panels */
.task-panel, .timer-panel{
  background:var(--glass-bg); backdrop-filter:blur(20px); 
  border:1px solid var(--glass-border); border-radius:var(--radius-lg); 
  padding:24px; box-shadow:var(--shadow-lg);
  animation: fadeIn 0.6s ease-out;
}
.panel-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:20px}
.panel-header h2{margin:0; font-size:20px; font-weight:700; color:var(--text)}

/* Cards */
.card{
  background:var(--glass-bg); backdrop-filter:blur(20px); 
  border:1px solid var(--glass-border); border-radius:var(--radius-lg); 
  padding:24px; box-shadow:var(--shadow-lg);
  transition: all 0.3s ease; animation: fadeIn 0.5s ease-out;
}
.card:hover{transform:translateY(-2px); box-shadow:var(--shadow-xl)}
.card-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:20px}
.card-header h2{margin:0; font-size:20px; font-weight:700}
.task-actions{display:flex; gap:6px; align-items:center; flex-wrap:nowrap}
.task-actions .btn-icon{
  background:var(--primary); color:var(--bg); border:1px solid var(--primary);
  font-size:16px; font-weight:600; flex-shrink:0;
}
.task-actions .btn-icon:hover{
  background:var(--primary-dark); border-color:var(--primary-dark);
  transform:translateY(-2px); box-shadow:var(--shadow-lg);
}

/* レスポンシブ対応: 小さい画面でのタスクアクション */
@media (max-width:480px){
  .task-actions{
    flex-wrap:wrap; gap:4px;
  }
  .task-actions .btn-icon{
    font-size:14px;
  }
}

/* Buttons */
button{
  border:none; border-radius:var(--radius); cursor:pointer; font-size:14px; font-weight:600; 
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position:relative; overflow:hidden;
}
button::before{
  content:''; position:absolute; top:50%; left:50%; width:0; height:0;
  background:rgba(255,255,255,0.2); border-radius:50%; 
  transition:all 0.3s ease; transform:translate(-50%,-50%);
}
button:active::before{width:300px; height:300px}

.btn-icon{
  width:40px; height:40px; display:flex; align-items:center; justify-content:center; font-size:16px;
  background:var(--secondary); color:var(--text); border:1px solid var(--border);
}
.btn-icon:hover{
  background:var(--secondary-light); transform:translateY(-2px) scale(1.05); 
  box-shadow:var(--shadow-lg);
}
.btn-small{
  padding:8px 16px; font-size:12px; background:var(--secondary); color:var(--text);
  border:1px solid var(--border);
}
.btn-small:hover{background:var(--secondary-light); transform:translateY(-1px)}
.btn-medium{
  padding:12px 20px; background:var(--secondary); color:var(--text);
  border:1px solid var(--border);
}
.btn-medium:hover{background:var(--secondary-light); transform:translateY(-1px)}
.btn-large{
  padding:16px 24px; font-size:16px; display:flex; align-items:center; gap:8px; 
  background:var(--secondary); color:var(--text); border:1px solid var(--border);
  font-weight:700;
}
.btn-large:hover{background:var(--secondary-light); transform:translateY(-2px)}

button.primary{background:var(--gradient-primary); color:white; border:none}
button.primary:hover{transform:translateY(-2px) scale(1.02); box-shadow:var(--shadow-xl)}
button.secondary{background:var(--secondary); color:var(--text)}
button.secondary:hover{background:var(--secondary-light)}
button.danger{background:var(--gradient-danger); color:white; border:none}
button.danger:hover{transform:translateY(-2px) scale(1.02); box-shadow:var(--shadow-xl)}
button:disabled{opacity:.4; cursor:not-allowed; transform:none}
button:disabled:hover{transform:none; box-shadow:none}

/* Current Task Display */
.current-task-card{background:var(--bg-3); border:1px solid var(--border-light); border-radius:var(--radius); padding:16px; margin-bottom:20px}
.task-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:8px}
.current-label{font-size:12px; color:var(--text-muted); font-weight:500}
.current-task .task-title{font-size:16px; font-weight:600; color:var(--text); margin-bottom:4px}
.current-task .task-meta{font-size:12px; color:var(--text-muted); margin-bottom:4px}
.current-task .task-notes{font-size:12px; color:var(--text-light); font-style:italic; margin-bottom:4px}
.current-task .task-amount{font-size:13px; color:var(--text-light); margin-bottom:4px}

/* Task Amount Controls */
.task-amount-controls{
  margin-top:8px; display:flex; gap:6px; align-items:center; flex-wrap:nowrap;
  justify-content:flex-start;
}
.task-amount-controls .btn-icon{
  width:32px; height:32px; font-size:14px; font-weight:700;
  background:var(--secondary); color:var(--text); border:1px solid var(--border);
  flex-shrink:0;
}
.task-amount-controls .btn-small{
  background:var(--secondary); color:var(--text); border:1px solid var(--border);
  white-space:nowrap; flex-shrink:0;
}
.task-amount-controls .btn-small.primary{
  background:var(--primary); color:var(--bg); border-color:var(--primary);
}
.task-amount-controls .btn-small.primary:hover{
  background:var(--primary-dark); border-color:var(--primary-dark);
}
#current-amount-display{
  font-weight:bold; color:var(--primary); font-size:14px; min-width:60px; text-align:center;
  flex-shrink:0;
}

/* レスポンシブ対応: 小さい画面では縦並びに */
@media (max-width:400px){
  .task-amount-controls{
    flex-wrap:wrap; gap:4px;
  }
  .task-amount-controls .btn-small{
    flex:1; min-width:60px;
  }
  
  /* タスクアクションボタンのレスポンシブ */
  .task-item .task-actions{
    flex-direction:column; gap:8px; align-items:stretch;
  }
  .task-item .task-actions > div{
    justify-content:center;
  }
  .task-item .task-actions .btn-icon{
    width:36px; height:36px; font-size:14px;
  }
}

/* Task Selector (Simple View) */
.task-selector{
  background:var(--bg-3); border:1px solid var(--border-light); 
  border-radius:var(--radius); padding:16px; margin-bottom:16px;
}
.task-selector select{
  width:100%; padding:8px 12px; background:var(--card); color:var(--text);
  border:1px solid var(--border); border-radius:var(--radius); margin-bottom:12px;
}
.task-selector .btn-small{
  margin-right:8px; margin-bottom:4px;
}
.current-task .task-title{font-size:16px; font-weight:600; color:var(--text); margin-bottom:4px}
.current-task .task-meta{font-size:12px; color:var(--text-muted); margin-bottom:4px}
.current-task .task-notes{font-size:12px; color:var(--text-light); font-style:italic}

/* Task List */
.task-list h3{margin:0 0 12px 0; font-size:14px; color:var(--text-muted); font-weight:500}
.task-items{display:flex; flex-direction:column; gap:8px}

/* Folder Filter */
.folder-filter{margin-bottom:16px; display:flex; flex-direction:column; gap:8px;}
.folder-filter select{padding:8px 12px; border:1px solid var(--border); border-radius:var(--radius); background:var(--card); color:var(--text); font-size:12px;}
.task-filter{display:flex; gap:4px;}
/* Filter Buttons */
.folder-filter{margin-bottom:16px}
.folder-filter select{
  width:100%; padding:8px 12px; background:var(--bg-3); color:var(--text);
  border:1px solid var(--border); border-radius:var(--radius); margin-bottom:8px;
}
.task-filter{display:flex; gap:4px}
.filter-btn{
  flex:1; padding:6px 8px; border:1px solid var(--border); border-radius:var(--radius); 
  background:var(--card); color:var(--text-muted); font-size:11px; cursor:pointer; 
  transition:all 0.2s ease; text-align:center;
}
.filter-btn:hover{background:var(--card-hover); border-color:var(--border-light); color:var(--text);}
.filter-btn.active{background:var(--primary); color:white; border-color:var(--primary); font-weight:600;}

/* Folder Form */
.folder-form{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:16px; margin-bottom:16px;}
.folder-form input[type="color"]{width:60px; height:32px; border:1px solid var(--border); border-radius:4px; cursor:pointer;}

/* Task Item Extensions */
.task-item.completed{
  opacity: 0.8;
  background: color-mix(in lab, var(--success) 5%, var(--card-hover));
  border-color: color-mix(in lab, var(--success) 20%, var(--border));
}
.task-item.completed .task-name{
  text-decoration: line-through;
  color: var(--text-muted);
}
.folder-indicator{
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,0.3);
}
.btn-icon.danger{
  color: var(--danger);
}
.btn-icon.danger:hover{
  background: color-mix(in lab, var(--danger) 10%, transparent);
}

/* Task Item */
.task-item{
  background:var(--glass-bg); backdrop-filter:blur(20px); 
  border:1px solid var(--glass-border); border-radius:var(--radius-lg); 
  padding:20px; cursor:pointer; transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
  position:relative; margin-bottom:8px; overflow:hidden;
  animation:fadeIn 0.5s ease-out;
}
.task-item::before{
  content:''; position:absolute; top:0; left:0; right:0; bottom:0;
  background:linear-gradient(135deg, transparent, rgba(255,255,255,0.05), transparent);
  opacity:0; transition:opacity 0.3s ease;
}
.task-item:hover::before{opacity:1}
.task-item:hover{
  background:var(--card-hover); border-color:var(--border-light); 
  transform:translateY(-3px) scale(1.01); box-shadow:var(--shadow-xl);
}
.task-item.active{
  border-color:var(--primary); background:color-mix(in lab, var(--primary) 10%, transparent);
  box-shadow:0 0 20px rgba(34,197,94,0.3); animation:glow 3s infinite;
}
.task-item.active::after{
  content:''; position:absolute; left:0; top:0; bottom:0; width:4px;
  background:var(--gradient-primary); border-radius:0 4px 4px 0;
}
.task-item.completed{
  opacity:0.8; background:color-mix(in lab, var(--success) 5%, var(--card-hover));
  border-color:color-mix(in lab, var(--success) 20%, var(--border));
}
.task-item.completed .task-name{
  text-decoration:line-through; color:var(--text-muted);
}
.task-item .task-name{font-weight:600; margin-bottom:6px; font-size:16px}
.task-item .task-subject{font-size:13px; color:var(--text-muted); font-weight:500}
.task-item .task-progress{margin-top:12px}

/* タスクアクション（タスクリスト内のボタン）の修正 */
.task-item .task-actions{
  margin-top:8px; display:flex; gap:6px; justify-content:space-between;
  align-items:center; flex-wrap:nowrap;
}
.task-item .task-actions > div{
  display:flex; gap:4px; align-items:center;
}
.task-item .task-actions .btn-icon{
  width:28px; height:28px; font-size:12px; padding:0;
  display:flex; align-items:center; justify-content:center;
  background:var(--secondary); color:var(--text); border:1px solid var(--border);
  flex-shrink:0;
}
.task-item .task-actions .btn-icon:hover{
  background:var(--secondary-light); transform:translateY(-1px);
}
.task-item .task-actions .btn-icon.danger{
  background:var(--danger); color:white;
}
.task-item .task-actions .btn-icon.danger:hover{
  background:#dc2626;
}

/* Progress Bars */
.progress-bar-container{
  background:var(--bg-3); border-radius:8px; height:12px; overflow:hidden; 
  margin-top:6px; box-shadow:inset 0 2px 4px rgba(0,0,0,0.2);
  position:relative;
}
.progress-bar-container::before{
  content:''; position:absolute; top:0; left:0; right:0; bottom:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  animation:shimmer 2s infinite;
}
@keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }
.progress-bar-fill{
  background:var(--gradient-primary); height:100%; border-radius:8px; 
  transition:width 0.8s cubic-bezier(0.4, 0, 0.2, 1); 
  box-shadow:0 2px 8px rgba(34,197,94,0.3);
  position:relative; overflow:hidden;
}
.progress-bar-fill::before{
  content:''; position:absolute; top:0; left:0; right:0; bottom:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  animation:shimmer 1.5s infinite;
}
.progress-text{font-size:11px; color:var(--text-muted); margin-top:4px; font-weight:500}

/* Timer Container */
.timer-container{text-align:center; position:relative; padding:20px}
.session-info{
  margin-bottom:40px; padding:16px; background:var(--glass-bg);
  backdrop-filter:blur(20px); border:1px solid var(--glass-border);
  border-radius:var(--radius); animation:fadeIn 0.5s ease-out;
  display:flex; justify-content:center; align-items:center; gap:16px;
}
.timer-mode{
  font-size:20px; color:var(--text-light); font-weight:700;
}
.separator{margin:0 12px; color:var(--text-muted)}

/* Progress Ring */
.progress-ring{
  position:relative; display:inline-block; margin-bottom:32px;
  width:240px; height:240px;
}
.progress-svg{
  transform:rotate(-90deg); filter:drop-shadow(0 4px 8px rgba(0,0,0,0.3));
  width:240px; height:240px; display:block;
}
.progress-bg{fill:none; stroke:var(--border); stroke-width:8}
.progress-bar{
  fill:none; stroke:url(#progressGradient); stroke-width:10; stroke-linecap:round; 
  stroke-dasharray:628.32; stroke-dashoffset:628.32; 
  transition:stroke-dashoffset 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  filter:drop-shadow(0 0 8px rgba(34,197,94,0.4));
}
.timer-display{
  position:absolute; top:0; left:0; right:0; bottom:0;
  display:flex; flex-direction:column; justify-content:center; align-items:center;
  text-align:center; pointer-events:none;
}
.time{
  font-size:48px; font-weight:900; letter-spacing:-1px; line-height:1;
  color:var(--primary);
  text-shadow:0 2px 4px rgba(0,0,0,0.3);
  margin:0;
}
/* Webkit向けのグラデーション効果（フォールバック付き） */
@supports (-webkit-background-clip: text) {
  .time {
    background:var(--gradient-primary); 
    -webkit-background-clip:text; 
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
}
.time-percent{
  font-size:16px; color:var(--text-muted); margin-top:6px; font-weight:600;
  margin:0;
}

/* Controls */
.controls{
  display:flex; flex-wrap:wrap; gap:16px; justify-content:center; 
  margin-bottom:32px; animation:slideIn 0.6s ease-out;
}

/* Session Stats */
.session-stats{
  display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:24px; 
  padding:20px; background:var(--glass-bg); backdrop-filter:blur(20px);
  border:1px solid var(--glass-border); border-radius:var(--radius);
}
.stat-item{
  text-align:center; padding:16px; background:var(--card); border-radius:var(--radius);
  transition:all 0.3s ease; cursor:pointer;
}
.stat-item:hover{transform:translateY(-2px); box-shadow:var(--shadow)}
.stat-label{display:block; font-size:12px; color:var(--text-muted); margin-bottom:8px; font-weight:600}
.stat-value{
  font-size:20px; font-weight:800; color:var(--primary);
}
/* Webkit向けのグラデーション効果（フォールバック付き） */
@supports (-webkit-background-clip: text) {
  .stat-value {
    background:var(--gradient-primary);
    -webkit-background-clip:text; 
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
}

/* Dashboard Stats */
.stats-overview{
  display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); 
  gap:20px; margin-bottom:32px;
}
.stat-card{
  background:var(--glass-bg); backdrop-filter:blur(20px); 
  border:1px solid var(--glass-border); border-radius:var(--radius-lg); 
  padding:24px; display:flex; align-items:center; gap:20px; 
  box-shadow:var(--shadow-lg); transition:all 0.3s ease;
  animation:fadeIn 0.5s ease-out;
}
.stat-card:hover{transform:translateY(-4px) scale(1.02); box-shadow:var(--shadow-xl)}
.stat-icon{
  font-size:40px; filter:drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  animation:bounce 2s infinite;
}
.stat-content .stat-value{
  font-size:32px; font-weight:900; line-height:1;
  color:var(--primary);
}
/* Webkit向けのグラデーション効果（フォールバック付き） */
@supports (-webkit-background-clip: text) {
  .stat-content .stat-value {
    background:var(--gradient-primary); 
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
}
.stat-content .stat-label{
  font-size:14px; color:var(--text-muted); margin-top:8px; font-weight:600;
}

/* Forms */
.task-form{
  background:var(--glass-bg); backdrop-filter:blur(20px); 
  border:1px solid var(--glass-border); border-radius:var(--radius-lg); 
  padding:24px; margin-top:20px; animation:fadeIn 0.5s ease-out;
}
.task-form h3{margin:0 0 20px 0; font-size:18px; font-weight:700}
.task-form input, .task-form select{
  width:100%; margin-bottom:16px; padding:12px 16px; 
  background:var(--card); color:var(--text); border:1px solid var(--border); 
  border-radius:var(--radius); font-size:14px; transition:all 0.3s ease;
}
.task-form input:focus, .task-form select:focus{
  outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(34,197,94,0.1);
  transform:translateY(-1px);
}
.goal-setting{margin:16px 0}
.goal-setting label{display:block; margin-bottom:6px; font-size:13px; color:var(--text-muted); font-weight:600}
.form-actions{display:flex; gap:12px; margin-top:24px; justify-content:flex-end}

/* Shortcuts hint */
.shortcuts-hint{margin-top:16px}
.shortcuts-hint kbd{background:var(--secondary); padding:2px 6px; border-radius:4px; font-size:11px}

/* Dashboard Layout */
.dashboard-layout{display:flex; flex-direction:column; gap:24px}
.stats-overview{display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin-bottom:24px}
.stat-card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:20px; display:flex; align-items:center; gap:16px; box-shadow:var(--shadow)}
.stat-icon{font-size:32px}
.stat-content .stat-value{font-size:28px; font-weight:700; line-height:1}
.stat-content .stat-label{font-size:12px; color:var(--text-muted); margin-top:4px}

/* Period Stats */
.period-stats{display:grid; grid-template-columns:1fr 1fr; gap:24px}
@media (max-width:768px){.period-stats{grid-template-columns:1fr}}

/* Cards */
.card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius-lg); padding:20px; box-shadow:var(--shadow)}
.card-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:16px}
.card-header h2{margin:0; font-size:18px; font-weight:600}
.period-nav{display:flex; align-items:center; gap:8px}
.current-period{font-size:14px; color:var(--text-muted); min-width:60px; text-align:center}

/* Summary */
.today-summary, .week-summary{display:flex; gap:24px; margin-bottom:20px; flex-wrap:wrap}
.summary-item{text-align:center}
.summary-label{display:block; font-size:12px; color:var(--text-muted); margin-bottom:4px}
.summary-value{font-size:18px; font-weight:600}

/* Progress Lists */
.task-progress-list{display:flex; flex-direction:column; gap:12px; margin-bottom:20px}
.task-progress-item{background:var(--bg-3); border-radius:var(--radius); padding:12px}
.task-progress-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:8px}
.task-name{font-weight:500}
.task-time{font-size:12px; color:var(--text-muted)}

/* Session History */
.session-history{max-height:200px; overflow-y:auto}
.session-item{display:flex; justify-content:space-between; align-items:center; padding:8px 0; border-bottom:1px solid var(--border)}
.session-item:last-child{border-bottom:none}
.session-time{font-size:12px; color:var(--text-muted)}

/* Week Chart */
.week-chart{margin-bottom:20px}
.chart-bars{display:flex; align-items:end; gap:4px; height:140px; margin-bottom:8px; padding:8px 0; justify-content:space-between;}
.chart-bar-container{display:flex; flex-direction:column; align-items:center; flex:1; min-height:140px;}
.chart-bar{transition:all 0.3s ease; cursor:pointer; position:relative; border-radius:4px 4px 0 0; min-height:4px;}
.chart-bar:hover{transform:scale(1.05); box-shadow:0 4px 8px rgba(0,0,0,0.2);}
.chart-labels{display:flex; justify-content:space-between}
.chart-labels span{font-size:10px; color:var(--text-muted)}

/* Task Breakdown */
.task-breakdown{display:flex; flex-direction:column; gap:8px}
.breakdown-item{display:flex; justify-content:space-between; align-items:center; padding:8px; background:var(--bg-3); border-radius:var(--radius)}
.breakdown-bar{height:4px; background:var(--bg-2); border-radius:2px; overflow:hidden; margin:4px 0}
.breakdown-fill{height:100%; background:var(--primary); border-radius:2px}

/* Settings Layout */
.settings-layout{display:flex; flex-direction:column; gap:20px; max-width:800px}
.settings-grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin-bottom:16px}
.setting-item{display:flex; flex-direction:column; gap:4px}
.setting-item label{font-size:12px; color:var(--text-muted); font-weight:500}
.setting-item input, .setting-item select{padding:8px; background:var(--bg-3); color:var(--text); border:1px solid var(--border); border-radius:var(--radius)}
.setting-item input:focus, .setting-item select:focus{outline:none; border-color:var(--primary)}

/* Checkbox */
.setting-item label input[type="checkbox"]{width:auto; margin-right:8px}
.checkbox-label{display:flex; align-items:center; cursor:pointer}

/* Setting Actions */
.setting-actions, .data-actions{display:flex; gap:12px; flex-wrap:wrap}
.goal-settings, .notification-settings, .appearance-settings{margin-bottom:16px}

/* Data Info */
.data-info{display:flex; gap:20px; margin:16px 0; flex-wrap:wrap}
.info-item{text-align:center}
.info-label{display:block; font-size:12px; color:var(--text-muted); margin-bottom:4px}
.info-value{font-size:16px; font-weight:600}

/* App Info */
.app-info{color:var(--text-muted); line-height:1.6}
.app-info p{margin:8px 0}

/* File Label */
.file-label{cursor:pointer}
.file-label input{display:none}
.file-label span{display:inline-block; padding:10px 16px; background:var(--secondary); color:var(--text); border-radius:var(--radius); transition:all 0.2s ease}
.file-label:hover span{background:var(--secondary-light)}

/* Utilities */
.hidden{display:none !important}
.sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0}
.hint{color:var(--text-muted); font-size:12px; margin:8px 0}
.text-center{text-align:center}
.mt-2{margin-top:8px}
.mb-2{margin-bottom:8px}

/* Tab Panes */
.tab-pane{display:none}
.tab-pane.is-active{display:block}

/* Footer */
.app-footer{padding:20px; text-align:center; color:var(--text-muted); border-top:1px solid var(--border); margin-top:40px}

/* Compact Mode */
[data-compact-mode="true"] .session-layout {
  grid-template-columns: 1fr;
}

[data-compact-mode="true"] .task-panel {
  order: 2;
}

[data-compact-mode="true"] .timer-panel {
  order: 1;
}

[data-compact-mode="true"] .session-stats {
  flex-direction: column;
  gap: 8px;
}

[data-compact-mode="true"] .stat-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

[data-compact-mode="true"] .container {
  padding: 8px;
}

[data-compact-mode="true"] .task-list {
  display: block;
}

[data-compact-mode="true"] .controls {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

@media (max-width:480px){
  .session-layout{grid-template-columns:1fr}
  .stats-overview{grid-template-columns:1fr}
  .period-stats{grid-template-columns:1fr}
  .settings-grid{grid-template-columns:1fr}
  .today-summary, .week-summary{flex-direction:column; gap:12px}
  .data-actions{flex-direction:column}
  .setting-actions{flex-direction:column}
  
  /* タイマーのレスポンシブ対応 */
  .progress-ring{
    width:200px; height:200px;
  }
  .progress-svg{
    width:200px; height:200px;
  }
  .time{
    font-size:36px;
  }
  .time-percent{
    font-size:14px;
  }
}

/* mini timer */
#mini-timer { 
  color: var(--text); display:flex; align-items:center; gap:8px;
  margin-top:6px; font-size:12px; font-weight:500;
}
#mini-timer .btn-small { 
  padding: 4px 8px; font-size: 11px; min-width:auto; height:auto;
}
